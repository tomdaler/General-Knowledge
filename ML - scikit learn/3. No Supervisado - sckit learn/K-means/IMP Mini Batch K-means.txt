import pandas as pd
from sklearn.cluster import MiniBatchKMeans

path = 'candy.csv'
dataset = pd.read_csv(path)
print(dataset.head(5))


# eliminar la columna QUE NO APORTA, NO SE CATEGORIZA, ES EL NOMBRE
x = dataset.drop('competitorname', axis=1)

#este archivo no tiene columna target

#no de clusters, 
#batch size, grupos de 8 datos
#==============================

kmeans = MiniBatchKMeans(n_clusters=4, batch_size=8).fit(x)

print('\nTotal de centros:', len(kmeans.cluster_centers_))
print('\nPredicciones:', kmeans.predict(x))


# UNA VEZ DEFINIDO EL GRUPO AL QUE PERTENECE SE LO ASIGNAMOS A CADA FILA
# ES COMO CREARLE SU TARGET

dataset['Grupo'] = kmeans.predict(x)
print(dataset)


