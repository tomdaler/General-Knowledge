
loop 
{
   PIR = type COM{4}

   if PIR ='1'
   {
      Set WshShell = WScript.CreateObject("WScript.Shell")
      WshShell.Run "c:\windows\system\camera.exe"
      WScript.Sleep 3000
      WshShell.SendKeys "{ENTER}"
      WScript.Sleep 3000
      WshShell.SendKeys "{ENTER}"
   }
}




%SendKeys% "echo off{ENTER}"


Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run "c:\windows\system\camera.exe"
WScript.Sleep 3000
WshShell.SendKeys "{ENTER}"
WScript.Sleep 3000
WshShell.SendKeys "{ENTER}"


Reading from COM:

type COM{n}

Sending info to COM:

echo some text > COM{n}



set fsObject=Wscript.CreateObject ("Scripting.FileSystemObject")
set listFile = fsObject.OpenTextFile ("com1")

do while listFile.AtEndOfStream <> True
   WScript.Echo listFile.ReadLine
loop




hModule := DllCall("LoadLibrary", "str", "c:\temp\Port.dll") 

result := DllCall("c:\temp\Port.dll\OPENCOM", "str", "COM1:57600,M,8,1")
msgbox OPEN %result%
loop 
{
result := DllCall("c:\temp\Port.dll\READBYTE")
ifnotequal, result, -1 
  {
  msgbox byte -%result%-
  break
  }
}
result := DllCall("c:\temp\Port.dll\CLOSECOM")
msgbox close %result%
result := DllCall("c:\temp\Port.dll\CLOSECOM")
msgbox close2 %result%
DllCall("FreeLibrary", "UInt", hModule)